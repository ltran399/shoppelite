{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import'./Confirmation.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Confirmation(){const[orderDetails,setOrderDetails]=useState(null);const userId=localStorage.getItem('userId');// Retrieve userId from localStorage\nconst cart=JSON.parse(localStorage.getItem('cart'));// Retrieve cart from localStorage\nconst token=localStorage.getItem('token');const navigate=useNavigate();useEffect(()=>{if(!userId||!cart||cart.length===0){navigate('/cart');// Redirect to cart if no user or cart items\nreturn;}const postOrder=async()=>{try{const response=await fetch('http://localhost:5002/api/place-order',{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${token}`},body:JSON.stringify({userId,items:cart,status:'Pending'})});const data=await response.json();if(response.ok){setOrderDetails(data.order);// Store order details\nlocalStorage.removeItem('cart');// Clear cart items\n}else{console.error('Failed to place order:',data);}}catch(error){console.error('Error placing order:',error);}};postOrder();},[userId,cart,token,navigate]);return/*#__PURE__*/_jsxs(\"div\",{className:\"confirmation-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Congratulations, your order is placed!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Thank you for shopping with us.\"}),orderDetails&&/*#__PURE__*/_jsxs(\"div\",{className:\"order-summary\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Order Summary\"}),/*#__PURE__*/_jsx(\"ul\",{children:orderDetails.items.map(item=>/*#__PURE__*/_jsxs(\"li\",{children:[item.name,\" - \",item.quantity,\" x $\",item.price]},item.productId))}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Total: $\",orderDetails.totalAmount]})]})]});}export default Confirmation;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","Confirmation","orderDetails","setOrderDetails","userId","localStorage","getItem","cart","JSON","parse","token","navigate","length","postOrder","response","fetch","method","headers","body","stringify","items","status","data","json","ok","order","removeItem","console","error","className","children","map","item","name","quantity","price","productId","totalAmount"],"sources":["/Users/lamtran/Documents/ShopeeLite/shopeelite/src/components/Confirmation.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './Confirmation.css';\n\nfunction Confirmation() {\n  const [orderDetails, setOrderDetails] = useState(null);\n  const userId = localStorage.getItem('userId'); // Retrieve userId from localStorage\n  const cart = JSON.parse(localStorage.getItem('cart')); // Retrieve cart from localStorage\n  const token = localStorage.getItem('token');\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (!userId || !cart || cart.length === 0) {\n      navigate('/cart'); // Redirect to cart if no user or cart items\n      return;\n    }\n\n    const postOrder = async () => {\n      try {\n        const response = await fetch('http://localhost:5002/api/place-order', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${token}`,\n          },\n          body: JSON.stringify({\n            userId,\n            items: cart,\n            status: 'Pending',\n          }),\n        });\n\n        const data = await response.json();\n        if (response.ok) {\n          setOrderDetails(data.order); // Store order details\n          localStorage.removeItem('cart'); // Clear cart items\n        } else {\n          console.error('Failed to place order:', data);\n        }\n      } catch (error) {\n        console.error('Error placing order:', error);\n      }\n    };\n\n    postOrder();\n  }, [userId, cart, token, navigate]);\n\n  return (\n    <div className=\"confirmation-container\">\n      <h1>Congratulations, your order is placed!</h1>\n      <p>Thank you for shopping with us.</p>\n      {orderDetails && (\n        <div className=\"order-summary\">\n          <h2>Order Summary</h2>\n          <ul>\n            {orderDetails.items.map((item) => (\n              <li key={item.productId}>\n                {item.name} - {item.quantity} x ${item.price}\n              </li>\n            ))}\n          </ul>\n          <p>Total: ${orderDetails.totalAmount}</p>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Confirmation;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE5B,QAAS,CAAAC,YAAYA,CAAA,CAAG,CACtB,KAAM,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAGR,QAAQ,CAAC,IAAI,CAAC,CACtD,KAAM,CAAAS,MAAM,CAAGC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC,CAAE;AAC/C,KAAM,CAAAC,IAAI,CAAGC,IAAI,CAACC,KAAK,CAACJ,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAE;AACvD,KAAM,CAAAI,KAAK,CAAGL,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAK,QAAQ,CAAGf,WAAW,CAAC,CAAC,CAE9BF,SAAS,CAAC,IAAM,CACd,GAAI,CAACU,MAAM,EAAI,CAACG,IAAI,EAAIA,IAAI,CAACK,MAAM,GAAK,CAAC,CAAE,CACzCD,QAAQ,CAAC,OAAO,CAAC,CAAE;AACnB,OACF,CAEA,KAAM,CAAAE,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,uCAAuC,CAAE,CACpEC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,eAAe,CAAE,UAAUP,KAAK,EAClC,CAAC,CACDQ,IAAI,CAAEV,IAAI,CAACW,SAAS,CAAC,CACnBf,MAAM,CACNgB,KAAK,CAAEb,IAAI,CACXc,MAAM,CAAE,SACV,CAAC,CACH,CAAC,CAAC,CAEF,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAR,QAAQ,CAACS,IAAI,CAAC,CAAC,CAClC,GAAIT,QAAQ,CAACU,EAAE,CAAE,CACfrB,eAAe,CAACmB,IAAI,CAACG,KAAK,CAAC,CAAE;AAC7BpB,YAAY,CAACqB,UAAU,CAAC,MAAM,CAAC,CAAE;AACnC,CAAC,IAAM,CACLC,OAAO,CAACC,KAAK,CAAC,wBAAwB,CAAEN,IAAI,CAAC,CAC/C,CACF,CAAE,MAAOM,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC9C,CACF,CAAC,CAEDf,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,CAACT,MAAM,CAAEG,IAAI,CAAEG,KAAK,CAAEC,QAAQ,CAAC,CAAC,CAEnC,mBACEX,KAAA,QAAK6B,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrChC,IAAA,OAAAgC,QAAA,CAAI,wCAAsC,CAAI,CAAC,cAC/ChC,IAAA,MAAAgC,QAAA,CAAG,iCAA+B,CAAG,CAAC,CACrC5B,YAAY,eACXF,KAAA,QAAK6B,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BhC,IAAA,OAAAgC,QAAA,CAAI,eAAa,CAAI,CAAC,cACtBhC,IAAA,OAAAgC,QAAA,CACG5B,YAAY,CAACkB,KAAK,CAACW,GAAG,CAAEC,IAAI,eAC3BhC,KAAA,OAAA8B,QAAA,EACGE,IAAI,CAACC,IAAI,CAAC,KAAG,CAACD,IAAI,CAACE,QAAQ,CAAC,MAAI,CAACF,IAAI,CAACG,KAAK,GADrCH,IAAI,CAACI,SAEV,CACL,CAAC,CACA,CAAC,cACLpC,KAAA,MAAA8B,QAAA,EAAG,UAAQ,CAAC5B,YAAY,CAACmC,WAAW,EAAI,CAAC,EACtC,CACN,EACE,CAAC,CAEV,CAEA,cAAe,CAAApC,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}